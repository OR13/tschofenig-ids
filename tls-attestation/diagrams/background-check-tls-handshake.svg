<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1040" width="592" viewBox="0 0 592 1040" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
<path d="M 8,16 L 8,48" fill="none" stroke="black"/>
<path d="M 8,80 L 8,960" fill="none" stroke="black"/>
<path d="M 32,48 L 32,80" fill="none" stroke="black"/>
<path d="M 32,112 L 32,976" fill="none" stroke="black"/>
<path d="M 112,16 L 112,48" fill="none" stroke="black"/>
<path d="M 136,96 L 136,112" fill="none" stroke="black"/>
<path d="M 176,16 L 176,48" fill="none" stroke="black"/>
<path d="M 208,48 L 208,1024" fill="none" stroke="black"/>
<path d="M 240,16 L 240,48" fill="none" stroke="black"/>
<path d="M 376,16 L 376,48" fill="none" stroke="black"/>
<path d="M 408,48 L 408,560" fill="none" stroke="black"/>
<path d="M 408,592 L 408,1024" fill="none" stroke="black"/>
<path d="M 440,16 L 440,48" fill="none" stroke="black"/>
<path d="M 496,16 L 496,48" fill="none" stroke="black"/>
<path d="M 536,48 L 536,976" fill="none" stroke="black"/>
<path d="M 576,128 L 576,960" fill="none" stroke="black"/>
<path d="M 584,16 L 584,48" fill="none" stroke="black"/>
<path d="M 8,16 L 112,16" fill="none" stroke="black"/>
<path d="M 176,16 L 240,16" fill="none" stroke="black"/>
<path d="M 376,16 L 440,16" fill="none" stroke="black"/>
<path d="M 496,16 L 584,16" fill="none" stroke="black"/>
<path d="M 8,48 L 112,48" fill="none" stroke="black"/>
<path d="M 176,48 L 240,48" fill="none" stroke="black"/>
<path d="M 376,48 L 440,48" fill="none" stroke="black"/>
<path d="M 496,48 L 584,48" fill="none" stroke="black"/>
<path d="M 8,80 L 120,80" fill="none" stroke="black"/>
<path d="M 8,112 L 560,112" fill="none" stroke="black"/>
<path d="M 40,144 L 208,144" fill="none" stroke="black"/>
<path d="M 32,256 L 200,256" fill="none" stroke="black"/>
<path d="M 408,432 L 528,432" fill="none" stroke="black"/>
<path d="M 416,464 L 536,464" fill="none" stroke="black"/>
<path d="M 408,496 L 528,496" fill="none" stroke="black"/>
<path d="M 416,528 L 536,528" fill="none" stroke="black"/>
<path d="M 40,752 L 208,752" fill="none" stroke="black"/>
<path d="M 32,816 L 200,816" fill="none" stroke="black"/>
<path d="M 208,832 L 232,832" fill="none" stroke="black"/>
<path d="M 216,864 L 232,864" fill="none" stroke="black"/>
<path d="M 208,880 L 232,880" fill="none" stroke="black"/>
<path d="M 216,912 L 232,912" fill="none" stroke="black"/>
<path d="M 208,944 L 400,944" fill="none" stroke="black"/>
<path d="M 24,976 L 560,976" fill="none" stroke="black"/>
<path d="M 216,1008 L 400,1008" fill="none" stroke="black"/>
<path d="M 120,80 C 128.83064,80 136,87.16936 136,96" fill="none" stroke="black"/>
<path d="M 560,112 C 568.83064,112 576,119.16936 576,128" fill="none" stroke="black"/>
<path d="M 232,832 C 240.83064,832 248,839.16936 248,848" fill="none" stroke="black"/>
<path d="M 232,864 C 240.83064,864 248,856.83064 248,848" fill="none" stroke="black"/>
<path d="M 232,880 C 240.83064,880 248,887.16936 248,896" fill="none" stroke="black"/>
<path d="M 232,912 C 240.83064,912 248,904.83064 248,896" fill="none" stroke="black"/>
<path d="M 24,976 C 15.16936,976 8,968.83064 8,960" fill="none" stroke="black"/>
<path d="M 560,976 C 568.83064,976 576,968.83064 576,960" fill="none" stroke="black"/>
<polygon class="arrowhead" points="536,496 524,490.4 524,501.6 " fill="black" transform="rotate(0,528,496)"/>
<polygon class="arrowhead" points="536,432 524,426.4 524,437.6 " fill="black" transform="rotate(0,528,432)"/>
<polygon class="arrowhead" points="424,528 412,522.4 412,533.6 " fill="black" transform="rotate(180,416,528)"/>
<polygon class="arrowhead" points="424,464 412,458.4 412,469.6 " fill="black" transform="rotate(180,416,464)"/>
<polygon class="arrowhead" points="408,1008 396,1002.4 396,1013.6 " fill="black" transform="rotate(0,400,1008)"/>
<polygon class="arrowhead" points="408,944 396,938.4 396,949.6 " fill="black" transform="rotate(0,400,944)"/>
<polygon class="arrowhead" points="224,1008 212,1002.4 212,1013.6 " fill="black" transform="rotate(180,216,1008)"/>
<polygon class="arrowhead" points="224,912 212,906.4 212,917.6 " fill="black" transform="rotate(180,216,912)"/>
<polygon class="arrowhead" points="224,864 212,858.4 212,869.6 " fill="black" transform="rotate(180,216,864)"/>
<polygon class="arrowhead" points="208,816 196,810.4 196,821.6 " fill="black" transform="rotate(0,200,816)"/>
<polygon class="arrowhead" points="208,256 196,250.4 196,261.6 " fill="black" transform="rotate(0,200,256)"/>
<polygon class="arrowhead" points="48,752 36,746.4 36,757.6 " fill="black" transform="rotate(180,40,752)"/>
<polygon class="arrowhead" points="48,144 36,138.4 36,149.6 " fill="black" transform="rotate(180,40,144)"/>
<g class="text">
<text x="60" y="36">Verifier X</text>
<text x="208" y="36">TLS A</text>
<text x="408" y="36">TLS B</text>
<text x="540" y="36">Attester</text>
<text x="72" y="100">TLS handshake</text>
<text x="116" y="132">POST /newSession</text>
<text x="88" y="164">201 Created</text>
<text x="120" y="180">Location: /76839A9E</text>
<text x="72" y="196">Body: {</text>
<text x="84" y="212">nonce,</text>
<text x="124" y="228">supp-media-types</text>
<text x="48" y="244">}</text>
<text x="264" y="276">ClientHello</text>
<text x="248" y="292">{...}</text>
<text x="312" y="308">attested-key-ext-req(</text>
<text x="268" y="324">nonce,</text>
<text x="308" y="340">supp-media-types</text>
<text x="232" y="356">)</text>
<text x="464" y="372">attest_key(</text>
<text x="460" y="388">nonce,</text>
<text x="448" y="404">TIK</text>
<text x="424" y="420">)</text>
<text x="464" y="452">KAT</text>
<text x="472" y="484">sign(TIK, hs)</text>
<text x="464" y="516">sig</text>
<text x="264" y="548">ServerHello</text>
<text x="248" y="564">{...}</text>
<text x="328" y="580">attested-key-ext-provide(</text>
<text x="300" y="596">kat-media-type</text>
<text x="232" y="612">)</text>
<text x="284" y="628">Certificate(KAT)</text>
<text x="308" y="644">CertificateVerify(sig)</text>
<text x="252" y="660">Finished</text>
<text x="100" y="676">POST /76839A9E</text>
<text x="72" y="692">Body: {</text>
<text x="120" y="708">kat-media-type,</text>
<text x="72" y="724">KAT</text>
<text x="48" y="740">}</text>
<text x="72" y="772">Body: {</text>
<text x="124" y="788">att-result: AR{}</text>
<text x="48" y="804">}</text>
<text x="304" y="852">verify AR{}</text>
<text x="300" y="900">verify sig</text>
<text x="300" y="932">Finished</text>
<text x="308" y="996">application data</text>
</g>
</svg>
