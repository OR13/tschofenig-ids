<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.3 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc rfcedstyle="yes"?>
<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc text-list-symbols="-o*+"?>
<?rfc docmapping="yes"?>

<rfc ipr="pre5378Trust200902" docName="draft-tschofenig-uta-tls13-profile-02" category="info">

  <front>
    <title abbrev="TLS/DTLS 1.3 IoT Profiles">TLS/DTLS 1.3 Profiles for the Internet of Things</title>

    <author initials="H." surname="Tschofenig" fullname="Hannes Tschofenig">
      <organization>Arm Limited</organization>
      <address>
        <email>hannes.tschofenig@arm.com</email>
      </address>
    </author>
    <author initials="T." surname="Fossati" fullname="Thomas Fossati">
      <organization>Arm Limited</organization>
      <address>
        <email>Thomas.Fossati@arm.com</email>
      </address>
    </author>

    <date year="2019" month="November" day="4"/>

    <area>Security</area>
    <workgroup>UTA</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document is a companion to RFC 7925 and defines TLS/DTLS 1.3 profiles 
   for Internet of Things devices.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>This document defines a profile of DTLS 1.3 <xref target="I-D.ietf-tls-dtls13"/> and
   TLS 1.3 <xref target="RFC8446"/> that offers communication security services for IoT
   applications and is reasonably implementable on many constrained
   devices. Profile thereby means that available configuration options
   and protocol extensions are utilized to best support the IoT
   environment.</t>

<t>For IoT profiles using TLS/DTLS 1.2 please consult <xref target="RFC7925"/>. This document
   re-uses the communication pattern defined in RFC 7925 and makes IoT-domain 
   specific recommendations for version 1.3 (where necessary).</t>

<t>TLS 1.3 has been re-designed and several previously defined extensions are not applicable 
   to the new version of TLS/DTLS anymore. This clean-up also simplifies this document. 
   Furthermore, many outdated ciphersuites have been omitted from the TLS/DTLS 1.3 specification.</t>

</section>
<section anchor="conventions-and-terminology" title="Conventions and Terminology">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in RFC 2119 <xref target="RFC2119"/>.</t>

</section>
<section anchor="credential-types" title="Credential Types">

<t>In accordance with the recommendations in <xref target="RFC7925"/> a compliant implementation 
MUST implement TLS_AES_128_CCM_8_SHA256. It SHOULD implement 
TLS_CHACHA20_POLY1305_SHA256.</t>

<t>Pre-shared key based authentication is integrated into the 
main TLS/DTLS 1.3 specification and has been harmonized with session resumption.</t>

<t>A compliant implementation supporting authentication based on certificates and raw public keys
MUST support digital signatures with ecdsa_secp256r1_sha256. A compliant implementation 
MUST support the key exchange with secp256r1 (NIST P-256) and SHOULD support key exchange with X25519.</t>

<t>A plain PSK-based TLS/DTLS client or server MUST implement the following extensions:</t> 
<t>
<list style="symbols"> 
  <t>supported_versions</t>
  <t>cookie </t>
  <t>server_name</t>
  <t>pre_shared_key</t>
  <t>psk_key_exchange_modes</t>
</list> 
</t> 

<t>For TLS/DTLS clients and servers implementing raw public keys and/or certificates the guidance for mandatory-to-implement extensions 
described in Section 9.2 of <xref target="RFC8446"/> MUST be followed.</t>

</section>
<section anchor="error-handling" title="Error Handling">

<t>TLS 1.3 simplified the Alert protocol but the underlying challenge in an embedded context remains unchanged, namely
what should an IoT device do when it encounters an error situation. The classical approach used in a desktop environment 
where the user is prompted is often not applicable with unattended devices. Hence, it is more important for 
a developer to find out from which error cases a device can recover from.</t>

</section>
<section anchor="session-resumption" title="Session Resumption">

<t>TLS 1.3 has built-in support for session resumption by utilizing PSK-based credentials established in an earlier 
exchange.</t>

</section>
<section anchor="compression" title="Compression">

<t>TLS 1.3 does not have support for compression.</t>

</section>
<section anchor="perfect-forward-secrecy" title="Perfect Forward Secrecy">

<t>TLS 1.3 allows the use of PFS with all ciphersuites since the support for it is negotiated independently.</t>

</section>
<section anchor="keep-alive" title="Keep-Alive">

<t>The discussion in Section 10 of RFC 7925 is applicable.</t>

</section>
<section anchor="timeouts" title="Timeouts">

<t>The recommendation in Section 11 of RFC 7925 is applicable. In particular this document RECOMMENDED to use 
an initial timer value of 9 seconds with exponential back off up to no less then 60 seconds.</t>

</section>
<section anchor="random-number-generation" title="Random Number Generation">

<t>The discussion in Section 12 of RFC 7925 is applicable with one exception: the ClientHello and the ServerHello messages 
in TLS 1.3 do not contain gmt_unix_time component anymore.</t>

</section>
<section anchor="server-name-indication-sni" title="Server Name Indication (SNI)">

<t>This specification mandates the implementation of the SNI extension.</t>

</section>
<section anchor="maximum-fragment-length-negotiation" title="Maximum Fragment Length Negotiation">

<t>The Maximum Fragment Length Negotiation (MFL) extension has been superseded by the Record Size Limit (RSL) extension <xref target="RFC8449"/>. Implementations in compliance with this specification MUST implement the RSL extension and SHOULD use it to indicate their RAM limitations.</t>

</section>
<section anchor="crypto-agility" title="Crypto Agility">

<t>The recommendations in Section 19 of RFC 7925 are applicable.</t>

</section>
<section anchor="key-length-recommendations" title="Key Length Recommendations">

<t>The recommendations in Section 20 of RFC 7925 are applicable.</t>

</section>
<section anchor="rtt-data" title="0-RTT Data">

<t>When clients and servers share a PSK, TLS/DTLS 1.3 allows clients to send data on the
first flight (“early data”). This features reduces communication setup latency but requires 
application layer protocols to define its use with the 0-RTT data functionality.</t>

<t>For HTTP this functionality is described in <xref target="I-D.ietf-httpbis-replay"/>. This document 
specifies the application profile for CoAP.</t>

<t>For a given request, the level of tolerance to replay risk is
specific to the resource it operates upon (and therefore only known
to the origin server).  In general, if processing a request does not
have state-changing side effects, the consequences of replay are not
significant. The server can choose whether it will process early data before
the TLS handshake completes.</t>

<t>It is RECOMMENDED that origin servers allow resources to explicitly
configure whether early data is appropriate in requests.</t>

<t>This specification defines a new CoAP option “timestamp”, which allows the 
server to attach a timestamp to each CoAP message for the purpose of replay
detection.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>This entire document is about security.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>


<reference  anchor='RFC8446' target='https://www.rfc-editor.org/info/rfc8446'>
<front>
<title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
<author initials='E.' surname='Rescorla' fullname='E. Rescorla'><organization /></author>
<date year='2018' month='August' />
<abstract><t>This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t><t>This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t></abstract>
</front>
<seriesInfo name='RFC' value='8446'/>
<seriesInfo name='DOI' value='10.17487/RFC8446'/>
</reference>


<reference anchor="I-D.ietf-tls-dtls13">
<front>
<title>The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</title>

<author initials='E' surname='Rescorla' fullname='Eric Rescorla'>
    <organization />
</author>

<author initials='H' surname='Tschofenig' fullname='Hannes Tschofenig'>
    <organization />
</author>

<author initials='N' surname='Modadugu' fullname='Nagendra Modadugu'>
    <organization />
</author>

<date month='October' year='2019' />

<abstract><t>This document specifies Version 1.3 of the Datagram Transport Layer Security (DTLS) protocol.  DTLS 1.3 allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.  The DTLS 1.3 protocol is intentionally based on the Transport Layer Security (TLS) 1.3 protocol and provides equivalent security guarantees.  Datagram semantics of the underlying transport are preserved by the DTLS protocol.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-tls-dtls13-33' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-33.txt' />
</reference>




<reference  anchor='RFC8449' target='https://www.rfc-editor.org/info/rfc8449'>
<front>
<title>Record Size Limit Extension for TLS</title>
<author initials='M.' surname='Thomson' fullname='M. Thomson'><organization /></author>
<date year='2018' month='August' />
<abstract><t>An extension to Transport Layer Security (TLS) is defined that allows endpoints to negotiate the maximum size of protected records that each will send the other.</t><t>This replaces the maximum fragment length extension defined in RFC 6066.</t></abstract>
</front>
<seriesInfo name='RFC' value='8449'/>
<seriesInfo name='DOI' value='10.17487/RFC8449'/>
</reference>




    </references>

    <references title='Informative References'>





<reference  anchor="RFC7925" target='https://www.rfc-editor.org/info/rfc7925'>
<front>
<title>Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</title>
<author initials='H.' surname='Tschofenig' fullname='H. Tschofenig' role='editor'><organization /></author>
<author initials='T.' surname='Fossati' fullname='T. Fossati'><organization /></author>
<date year='2016' month='July' />
<abstract><t>A common design pattern in Internet of Things (IoT) deployments is the use of a constrained device that collects data via sensors or controls actuators for use in home automation, industrial control systems, smart cities, and other IoT deployments.</t><t>This document defines a Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) 1.2 profile that offers communications security for this data exchange thereby preventing eavesdropping, tampering, and message forgery.  The lack of communication security is a common vulnerability in IoT products that can easily be solved by using these well-researched and widely deployed Internet security protocols.</t></abstract>
</front>
<seriesInfo name='RFC' value='7925'/>
<seriesInfo name='DOI' value='10.17487/RFC7925'/>
</reference>



<reference anchor="I-D.ietf-httpbis-replay">
<front>
<title>Using Early Data in HTTP</title>

<author initials='M' surname='Thomson' fullname='Martin Thomson'>
    <organization />
</author>

<author initials='M' surname='Nottingham' fullname='Mark Nottingham'>
    <organization />
</author>

<author initials='W' surname='Tarreau' fullname='Willy Tarreau'>
    <organization />
</author>

<date month='November' day='23' year='2017' />

<abstract><t>This document explains the risks of using early data for HTTP and describes techniques for reducing them.  In particular, it defines a mechanism that enables clients to communicate with servers about early data, to assure correct operation.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-httpbis-replay-02' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-httpbis-replay-02.txt' />
</reference>




    </references>


<section anchor="the-timestamp-option" title="The Timestamp Option">

<t>The Timestamp option encodes time in standard UNIX 32-bit format 
   (seconds since the midnight starting Jan 1, 1970, UTC, ignoring
   leap seconds) according to the sender’s internal clock.</t>

<figure title="Timestamp Option." anchor="timestamp-figure"><artwork><![CDATA[
   +-----+---+---+---+---+-------------+--------+--------+---------+---+
   | No. | C | U | N | R | Name        | Format | Length | Default | E |
   +-----+---+---+---+---+-------------+--------+--------+---------+---+
   | TBD |   |   |   |   | Timestamp   | opaque |   4    | (none)  | x |
   +-----+---+---+---+---+-------------+--------+--------+---------+---+

           C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable,
           E=Encrypt and Integrity Protect (when using OSCORE)
]]></artwork></figure>

</section>


  </back>


</rfc>

