<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.3 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc rfcedstyle="yes"?>
<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc text-list-symbols="-o*+"?>
<?rfc docmapping="yes"?>

<rfc ipr="pre5378Trust200902" docName="draft-tschofenig-uta-tls13-profile-01" category="info">

  <front>
    <title abbrev="TLS/DTLS 1.3 IoT Profiles">TLS/DTLS 1.3 Profiles for the Internet of Things</title>

    <author initials="H." surname="Tschofenig" fullname="Hannes Tschofenig">
      <organization>Arm Limited</organization>
      <address>
        <email>hannes.tschofenig@gmx.net</email>
      </address>
    </author>
    <author initials="T." surname="Fossati" fullname="Thomas Fossati">
      <organization>Nokia</organization>
      <address>
        <email>thomas.fossati@nokia.com</email>
      </address>
    </author>

    <date year="2018" month="October" day="21"/>

    <area>Security</area>
    <workgroup>UTA</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document is a companion to RFC 7925 and defines TLS/DTLS 1.3 profiles 
   for Internet of Things devices.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>This document defines a profile of DTLS 1.3 <xref target="I-D.ietf-tls-dtls13"/> and
   TLS 1.3 <xref target="RFC8446"/> that offers communication security services for IoT
   applications and is reasonably implementable on many constrained
   devices. Profile thereby means that available configuration options
   and protocol extensions are utilized to best support the IoT
   environment.</t>

<t>For IoT profiles using TLS/DTLS 1.2 please consult <xref target="RFC7925"/>. This document
   re-uses the communication pattern defined in RFC 7925 and makes IoT-domain 
   specific recommendations for version 1.3 (where necessary).</t>

<t>TLS 1.3 has been re-designed and several previously defined extensions are not applicable 
   to the new version of TLS/DTLS anymore. This clean-up also simplifies this document. 
   Furthermore, many outdated ciphersuites have been omitted from the TLS/DTLS 1.3 specification.</t>

</section>
<section anchor="conventions-and-terminology" title="Conventions and Terminology">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in RFC 2119 <xref target="RFC2119"/>.</t>

</section>
<section anchor="credential-types" title="Credential Types">

<t>In accordance with the recommendations in <xref target="RFC7925"/> a compliant implementation 
MUST implement TLS_AES_128_CCM_8_SHA256. It SHOULD implement 
TLS_CHACHA20_POLY1305_SHA256.</t>

<t>For use of a pre-shared secrets for authentication is now integrated into the 
main specification and does not rely on extensions, as it was the case with earlier 
versions. The support has also been aligned with the session resumption feature.</t>

<t>A compliant implementation supporting authentication based on certificates and raw public keys
MUST support digital signatures with ecdsa_secp256r1_sha256. A compliant implementation 
MUST support the key exchange with secp256r1 (NIST P-256) and SHOULD support key exchange with X25519.</t>

<t>A plain PSK-based TLS/DTLS client or server MUST implement the following extensions: 
  - supported_versions
  - cookie 
  - server_name
  - pre_shared_key
  - psk_key_exchange_modes</t>

<t>For TLS/DTLS clients and servers implementing raw public keys and/or certificates the guidance for mandatory-to-implement extensions 
described in Section 9.2 of <xref target="RFC8446"/> MUST be followed.</t>

</section>
<section anchor="error-handling" title="Error Handling">

<t>TLS 1.3 simplified the Alert protocol but the underlying challenge in an embedded context remains unchanged, namely
what should an IoT device do when it encounters an error situation. The classical approach used in a desktop environment 
where the user is prompted is often not applicable with unattended devices. Hence, it is more important for 
a developer to find out from situation situation the device can recover from and what situations are hopeless.</t>

</section>
<section anchor="session-resumption" title="Session Resumption">

<t>TLS 1.3 has built-in support for session resumption by utilizing PSK-based credentials established in an earlier 
exchange.</t>

</section>
<section anchor="compression" title="Compression">

<t>TLS 1.3 does not have support for compression.</t>

</section>
<section anchor="perfect-forward-secrecy" title="Perfect Forward Secrecy">

<t>TLS 1.3 allows the use of PFS with all ciphersuites since the support for it is negotiated independently.</t>

</section>
<section anchor="keep-alive" title="Keep-Alive">

<t>The discussion in Section 10 of RFC 7925 is applicable.</t>

</section>
<section anchor="timeouts" title="Timeouts">

<t>The recommendation in Section 11 of RFC 7925 is applicable. In particular this document RECOMMENDED to use 
an initial timer value of 9 seconds with exponential back off up to no less then 60 seconds.</t>

</section>
<section anchor="random-number-generation" title="Random Number Generation">

<t>The discussion in Section 12 of RFC 7925 is applicable with one exception: the ClientHello and the ServerHello messages 
in TLS 1.3 do not contain gmt_unix_time component anymore.</t>

</section>
<section anchor="server-name-indication-sni" title="Server Name Indication (SNI)">

<t>This specification mandates the implementation of the SNI extension.</t>

</section>
<section anchor="maximum-fragment-length-negotiation" title="Maximum Fragment Length Negotiation">

<t>The Maximum Fragment Length Negotiation (MFL) extension has been superseded by the Record Size Limit (RSL) extension <xref target="RFC8449"/>. Implementations in compliance with this specification MUST implement the RSL extension and SHOULD use it to indicate their RAM limitations.</t>

</section>
<section anchor="crypto-agility" title="Crypto Agility">

<t>The recommendations in Section 19 of RFC 7925 are applicable.</t>

</section>
<section anchor="key-length-recommendations" title="Key Length Recommendations">

<t>The recommendations in Section 20 of RFC 7925 are applicable.</t>

</section>
<section anchor="rtt-data" title="0-RTT Data">

<t>When clients and servers share a PSK, TLS/DTLS 1.3 allows clients to send data on the
first flight (“early data”). This is a great performance improvement but requires 
application protocols to define its use with the 0-RTT data functionality.</t>

<t>For HTTP this functionality is described in <xref target="I-D.ietf-httpbis-replay"/>. This document 
specifies the application profile for CoAP.</t>

<t>For a given request, the level of tolerance to replay risk is
specific to the resource it operates upon (and therefore only known
to the origin server).  In general, if processing a request does not
have state-changing side effects, the consequences of replay are not
significant. The server can choose whether it will process early data before
the TLS handshake completes.</t>

<t>It is RECOMMENDED that origin servers allow resources to explicitly
configure whether early data is appropriate in requests.</t>

<t>This specification defines a new CoAP option “timestamp”, which allows the 
server to attach a timestamp to each CoAP message for the purpose of replay
detection.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>This entire document is about security.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>


<reference  anchor='RFC8446' target='https://www.rfc-editor.org/info/rfc8446'>
<front>
<title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
<author initials='E.' surname='Rescorla' fullname='E. Rescorla'><organization /></author>
<date year='2018' month='August' />
<abstract><t>This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t><t>This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t></abstract>
</front>
<seriesInfo name='RFC' value='8446'/>
<seriesInfo name='DOI' value='10.17487/RFC8446'/>
</reference>


<reference anchor="I-D.ietf-tls-dtls13">
<front>
<title>The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</title>

<author initials='E' surname='Rescorla' fullname='Eric Rescorla'>
    <organization />
</author>

<author initials='H' surname='Tschofenig' fullname='Hannes Tschofenig'>
    <organization />
</author>

<author initials='N' surname='Modadugu' fullname='Nagendra Modadugu'>
    <organization />
</author>

<date month='July' day='2' year='2018' />

<abstract><t>This document specifies Version 1.3 of the Datagram Transport Layer Security (DTLS) protocol.  DTLS 1.3 allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.  The DTLS 1.3 protocol is intentionally based on the Transport Layer Security (TLS) 1.3 protocol and provides equivalent security guarantees.  Datagram semantics of the underlying transport are preserved by the DTLS protocol.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-tls-dtls13-28' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-28.txt' />
</reference>




<reference  anchor='RFC8449' target='https://www.rfc-editor.org/info/rfc8449'>
<front>
<title>Record Size Limit Extension for TLS</title>
<author initials='M.' surname='Thomson' fullname='M. Thomson'><organization /></author>
<date year='2018' month='August' />
<abstract><t>An extension to Transport Layer Security (TLS) is defined that allows endpoints to negotiate the maximum size of protected records that each will send the other.</t><t>This replaces the maximum fragment length extension defined in RFC 6066.</t></abstract>
</front>
<seriesInfo name='RFC' value='8449'/>
<seriesInfo name='DOI' value='10.17487/RFC8449'/>
</reference>




    </references>

    <references title='Informative References'>





<reference  anchor="RFC7925" target='https://www.rfc-editor.org/info/rfc7925'>
<front>
<title>Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</title>
<author initials='H.' surname='Tschofenig' fullname='H. Tschofenig' role='editor'><organization /></author>
<author initials='T.' surname='Fossati' fullname='T. Fossati'><organization /></author>
<date year='2016' month='July' />
<abstract><t>A common design pattern in Internet of Things (IoT) deployments is the use of a constrained device that collects data via sensors or controls actuators for use in home automation, industrial control systems, smart cities, and other IoT deployments.</t><t>This document defines a Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) 1.2 profile that offers communications security for this data exchange thereby preventing eavesdropping, tampering, and message forgery.  The lack of communication security is a common vulnerability in IoT products that can easily be solved by using these well-researched and widely deployed Internet security protocols.</t></abstract>
</front>
<seriesInfo name='RFC' value='7925'/>
<seriesInfo name='DOI' value='10.17487/RFC7925'/>
</reference>



<reference anchor="I-D.ietf-httpbis-replay">
<front>
<title>Using Early Data in HTTP</title>

<author initials='M' surname='Thomson' fullname='Martin Thomson'>
    <organization />
</author>

<author initials='M' surname='Nottingham' fullname='Mark Nottingham'>
    <organization />
</author>

<author initials='W' surname='Tarreau' fullname='Willy Tarreau'>
    <organization />
</author>

<date month='November' day='23' year='2017' />

<abstract><t>This document explains the risks of using early data for HTTP and describes techniques for reducing them.  In particular, it defines a mechanism that enables clients to communicate with servers about early data, to assure correct operation.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-httpbis-replay-02' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-httpbis-replay-02.txt' />
</reference>




    </references>


<section anchor="the-timestamp-option" title="The Timestamp Option">

<t>The Timestamp option encodes time in standard UNIX 32-bit format 
   (seconds since the midnight starting Jan 1, 1970, UTC, ignoring
   leap seconds) according to the sender’s internal clock.</t>

<figure title="Timestamp Option." anchor="timestamp-figure"><artwork><![CDATA[
   +-----+---+---+---+---+-------------+--------+--------+---------+---+
   | No. | C | U | N | R | Name        | Format | Length | Default | E |
   +-----+---+---+---+---+-------------+--------+--------+---------+---+
   | TBD |   |   |   |   | Timestamp   | opaque |   4    | (none)  | x |
   +-----+---+---+---+---+-------------+--------+--------+---------+---+

           C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable,
           E=Encrypt and Integrity Protect (when using OSCORE)
]]></artwork></figure>

</section>


  </back>

<!-- ##markdown-source:
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
pc1IHAAA

-->

</rfc>

