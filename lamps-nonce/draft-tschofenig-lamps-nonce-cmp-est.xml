<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.4 (Ruby 3.0.2) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

]>

<?rfc rfcedstyle="yes"?>
<?rfc tocindent="yes"?>
<?rfc strict="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc text-list-symbols="-o*+"?>
<?rfc docmapping="yes"?>

<rfc ipr="trust200902" docName="draft-tschofenig-lamps-nonce-cmp-est-01" category="std" consensus="true" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="Nonce Extension for CMP/EST">Nonce-based Freshness for Remote Attestation in Certificate Signing Requests (CSRs) for the Certification Management Protocol (CMP) and for Enrollment over Secure Transport (EST)</title>

    <author initials="H." surname="Tschofenig" fullname="Hannes Tschofenig">
      <organization>Siemens</organization>
      <address>
        <email>hannes.tschofenig@siemens.com</email>
      </address>
    </author>
    <author initials="H." surname="Brockhaus" fullname="Hendrik Brockhaus">
      <organization>Siemens</organization>
      <address>
        <email>hendrik.brockhaus@siemens.com</email>
      </address>
    </author>

    <date year="2024" month="February" day="26"/>

    <area>Security</area>
    <workgroup>LAMPS</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<?line 58?>

<t>Certificate Management Protocol (CMP) and Enrollment over Secure
Transport (EST) define protocol messages for X.509v3 certificate
creation and management. Both protocol provide interactions
between client systems and PKI management entities, such as a Registration
Authority (RA) and a Certification Authority (CA).</t>

<t>CMP and EST allow an RA/CA to request additional information it has to
provide in a certification request. When an end entity
places attestation Evidence in a Certificate Signing Request (CSR)
it may need to demonstrate freshness of the provided Evidence.
Attestation technology today often accomplishes this task via the
help of nonces.</t>

<t>This document specifies how nonces are provided by an RA/CA to
the end entity for inclusion in Evidence.</t>



    </abstract>



  </front>

  <middle>


<?line 76?>

<section anchor="introduction"><name>Introduction</name>

<t>Several protocols have been standardized to automate the management
of certificates, such as certificate issuance, CA certificate provisioning,
certificate renewal and certificate revocation.</t>

<t>The Certificate Management Protocol (CMP) <xref target="I-D.ietf-lamps-rfc4210bis"/>
defines protocol messages for X.509v3 certificate creation and
management. CMP provides interactions between end entities and
PKI components, such as a Registration Authority (RA) and a
Certification Authority (CA).</t>

<t>Enrollment over Secure Transport (EST) <xref target="RFC7030"/><xref target="RFC8295"/> is another
certificate management protocol, which provides a sub-set
of the features offered by CMP.</t>

<t>An end entity requesting a certificate from a Certification Authority (CA)
may wish to offer believable claims about the protections afforded
to the corresponding private key, such as whether the private key
resides on a hardware security module or the protection capabilities
provided by the hardware, and claims about the platform itself.</t>

<t>To convey these claims in Evidence, as part of remote attestation,
the remote attestation extension <xref target="I-D.ietf-lamps-csr-attestation"/> has
been defined. It describes how to encode Evidence produced by an Attester
for inclusion in Certificate Signing Requests (CSRs), and any
certificates necessary for validating it.</t>

<t>A Verifier or Relying Party might need to learn the point in time
an Evidence has been produced.  This is essential in deciding whether
the included Claims can be considered fresh, meaning they still reflect
the latest state of the Attester.</t>

<t>Attestation technology available today, such as <xref target="TPM20"/> and
<xref target="I-D.tschofenig-rats-psa-token"/>, often accomplish freshness with
the help of nonces. More details about ensuring freshness of Evidence
can be found in Section 10 of <xref target="RFC9334"/>.</t>

<t>Since an end entity needs to obtain a nonce from the Verifier via the
Relying Party, this leads to an additional roundtrip. The CSR is, however,
a one-shot message. For this reason CMP and EST are used by the end entity
to obtain the nonce from the RA/CA.</t>

<t>CMP and EST conveniently offer a mechanism to request
information from the RA/CA prior to a certification request.</t>

<t>Once the nonce
is obtained the end entity can issue an API call to the Attester
to request Evidence and passes the nonce as an input parameter
into the API call. The returned Evidence is then embedded into
a CSR and returned to the RA/CA in a certification request message.</t>

<t><xref target="fig-arch"/> shows this interaction graphically. The nonce is obtained
in step (1) using the extension to CMP/EST defined in this document.
The CSR extension of <xref target="I-D.ietf-lamps-csr-attestation"/> is used to
convey Evidence to the RA/CA in step (2). The Verifier processes the
received information and returns an Attestation Result to the Relying
Party in step (3).</t>

<figure title="Architecture with Background Check Model." anchor="fig-arch"><artset><artwork  type="svg"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="448" viewBox="0 0 448 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
<path d="M 8,176 L 8,320" fill="none" stroke="black"/>
<path d="M 48,240 L 48,272" fill="none" stroke="black"/>
<path d="M 112,176 L 112,320" fill="none" stroke="black"/>
<path d="M 240,32 L 240,96" fill="none" stroke="black"/>
<path d="M 240,176 L 240,200" fill="none" stroke="black"/>
<path d="M 240,216 L 240,320" fill="none" stroke="black"/>
<path d="M 280,104 L 280,208" fill="none" stroke="black"/>
<path d="M 320,104 L 320,240" fill="none" stroke="black"/>
<path d="M 344,104 L 344,168" fill="none" stroke="black"/>
<path d="M 368,32 L 368,96" fill="none" stroke="black"/>
<path d="M 368,176 L 368,320" fill="none" stroke="black"/>
<path d="M 240,32 L 368,32" fill="none" stroke="black"/>
<path d="M 240,96 L 368,96" fill="none" stroke="black"/>
<path d="M 8,176 L 112,176" fill="none" stroke="black"/>
<path d="M 240,176 L 272,176" fill="none" stroke="black"/>
<path d="M 288,176 L 312,176" fill="none" stroke="black"/>
<path d="M 328,176 L 368,176" fill="none" stroke="black"/>
<path d="M 120,208 L 280,208" fill="none" stroke="black"/>
<path d="M 120,240 L 232,240" fill="none" stroke="black"/>
<path d="M 248,240 L 320,240" fill="none" stroke="black"/>
<path d="M 8,320 L 112,320" fill="none" stroke="black"/>
<path d="M 240,320 L 368,320" fill="none" stroke="black"/>
<polygon class="arrowhead" points="352,168 340,162.4 340,173.6 " fill="black" transform="rotate(90,344,168)"/>
<polygon class="arrowhead" points="328,104 316,98.4 316,109.6 " fill="black" transform="rotate(270,320,104)"/>
<polygon class="arrowhead" points="240,240 228,234.4 228,245.6 " fill="black" transform="rotate(0,232,240)"/>
<polygon class="arrowhead" points="128,208 116,202.4 116,213.6 " fill="black" transform="rotate(180,120,208)"/>
<polygon class="arrowhead" points="56,272 44,266.4 44,277.6 " fill="black" transform="rotate(90,48,272)"/>
<polygon class="arrowhead" points="56,240 44,234.4 44,245.6 " fill="black" transform="rotate(270,48,240)"/>
<g class="text">
<text x="300" y="68">Verifier</text>
<text x="392" y="116">(3)</text>
<text x="400" y="132">Attestation</text>
<text x="396" y="148">Result</text>
<text x="168" y="164">(1)</text>
<text x="160" y="180">Nonce</text>
<text x="196" y="180">in</text>
<text x="152" y="196">CMP</text>
<text x="180" y="196">or</text>
<text x="208" y="196">EST</text>
<text x="40" y="212">End</text>
<text x="52" y="228">Entity</text>
<text x="172" y="260">Evidence</text>
<text x="280" y="260">Relying</text>
<text x="148" y="276">in</text>
<text x="176" y="276">CSR</text>
<text x="272" y="276">Party</text>
<text x="328" y="276">(RA/CA)</text>
<text x="60" y="292">Attester</text>
<text x="168" y="292">(2)</text>
</g>
</svg>
</artwork><artwork  type="ascii-art"><![CDATA[
                              .---------------.
                              |               |
                              |   Verifier    |
                              |               |
                              '---------------'
                                   |    ^  |    (3)
                                   |    |  | Attestation
                                   |    |  |   Result
                    (1)            |    |  v
 .------------.   Nonce in    .----|----|-----.
 |            |   CMP or EST  |    |    |     |
 |  End       |<-------------------+    |     |
 |  Entity    |               |         |     |
 |    ^       |-------------->|---------'     |
 |    |       |   Evidence    | Relying       |
 |    v       |   in CSR      | Party (RA/CA) |
 |  Attester  |     (2)       |               |
 |            |               |               |
 '------------'               '---------------'
]]></artwork></artset></figure>

<t>The functionality of this document is described in two
sections, namely:</t>

<t><list style="symbols">
  <t><xref target="CMP"/> describes how to convey the nonce CMP, and</t>
  <t><xref target="EST"/> offers the equivalent functionality for EST.</t>
</list></t>

</section>
<section anchor="terminology-and-requirements-language"><name>Terminology and Requirements Language</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119 <xref target="RFC2119"/>.</t>

<t>The terms Attester, Relying Party, Verifier and Evidence are defined
in <xref target="RFC9334"/>. The terms end entity, certification authority (CA),
and registration authority (RA) are defined in <xref target="RFC5280"/>.</t>

<t>We use the terms Certificate Signing Request (CSR) and certification
request interchangeably.</t>

</section>
<section anchor="CMP"><name>Conveying a Nonce in CMP</name>

<t>Section 5.3.19.16 of <xref target="I-D.ietf-lamps-rfc4210bis"/> defines the
general request message (genm) and general response (genp). 
The AttestationNonceRequest payload of the genm message, which is
send by the end entity to request a nonce, contains optional
details on the length of nonce the attester requires.  The
AttestationNonceResponse payload of the genp message, which is
sent by the CA/RA in response to a request message by the end
entity, contains the nonce.</t>

<figure><artwork><![CDATA[
 GenMsg:    {id-it TBD1}, AttestationNonceRequestValue
 GenRep:    {id-it TBD2}, AttestationNonceResponseValue | < absent >

 id-it-AttestationNonceRequest OBJECT IDENTIFIER ::= { id-it TBD1 }
 AttestationNonceRequestValue ::= SEQUENCE SIZE (1..MAX) OF
                                     AttestationNonceRequestContent

 AttestationNonceRequestContent ::= SEQUENCE {
    len ::= INTEGER OPTIONAL,
    -- indicates the required length of the requested nonce
    hint ::= EvidenceHint OPTIONAL
    -- indicates the verifier the needs to provide the nonce
 }

 id-it-AttestationNonceResponse OBJECT IDENTIFIER ::= { id-it TBD2 }
 AttestationNonceResponseValue ::= SEQUENCE SIZE (1..MAX) OF
                                      AttestationNonceResponseContent

 AttestationNonceResponseContent ::= SEQUENCE {
    nonce ::= OCTET STRING
    -- contains the nonce of length len
    -- provided by the verifier indicated with hint
 }
]]></artwork></figure>

<t>The use of the general request/response message exchange leads to an
extra roundtrip to convey the nonce from the CA/RA to the end entity
(and ultimately to the Attester inside the end entity).</t>

<t>The end entity MUST construct a AttestationNonceRequest request message to
trigger the RA/CA to transmit a nonce in the response.</t>

<t>When the RA/CA receive the AttestationNonceRequest content 
information is used to determine that the end entity supports this
specification as well as <xref target="I-D.ietf-lamps-csr-attestation"/>.</t>

<t>[Open Issue: Should request message indicate the remote attestation
capability of the end entity rather than relying on "policy
information"?  This may also allow to inform the CA/RA about the type
of attestation technology/technologies available to the end entity.]</t>

<t>If the end entity supports remote attestation and the policy requires
Evidence in a CSR to be provided, the RA/CA issues a AttestationNonceResponse
response containing a nonce.</t>

<t><xref target="fig-cmp-msg"/> showns the interaction graphically.</t>

<figure title="CMP Exchange with Nonce and Evidence." anchor="fig-cmp-msg"><artwork><![CDATA[
End Entity                                          RA/CA
==========                                      =============

              -->>-- AttestationNonceRequest -->>--
                                                Verify request
                                                Generate nonce*
                                                Create response
              --<<-- AttestationNonceResponse --<<--
                      (nonce)

Generate key pair
Generate Evidence*
Generate certification request message
              -->>-- certification request -->>--
                    (+Evidence including nonce)
                                               Verify request
                                               Verify Evidence*
                                               Check for replay*
                                               Issue certificate
                                               Create response
              --<<-- certification response --<<--
Handle response
Store certificate

*: These steps require interactions with the Attester
(on the EE side) and with the Verifier (on the RA/CA side).
]]></artwork></figure>

</section>
<section anchor="EST"><name>Conveying a Nonce in EST</name>

<t>The EST client can request an attestation nonce for its Attester.
This function is generally performed after requesting CA certificates
and before other EST functions.</t>

<t>The EST server MUST support the use of the path-prefix of "/.well-
known/" as defined in <xref target="RFC5785"/> and the registered name of "est".
Thus, a valid EST server URI path begins with
"https://www.example.com/.well-known/est".  Each EST operation is
indicated by a path-suffix that indicates the intended operation:</t>

<t>The following operation is defined by this specificaion:</t>

<figure><artwork><![CDATA[
 +------------------------+-----------------+-------------------+
 | Operation              |Operation path   | Details           |
 +========================+=================+===================+
 | Retrieval of a nonce   | /nonce          | This section      |
 +------------------------+-----------------+-------------------+
]]></artwork></figure>

<t>The operation path is appended to the path-prefix to form
the URI used with HTTP GET to perform the desired EST
operation.  An example valid URI absolute path for the "/nonce"
operation is "/.well-known/est/nonce".  To retrieve a nonce,
the EST client would use the following HTTP request-line:</t>

<figure><artwork><![CDATA[
GET /.well-known/est/nonce HTTP/1.1
]]></artwork></figure>

<t>The EST server MAY request HTTP-based client authentication, as
explained in Section 3.2.3 of <xref target="RFC7030"/>.</t>

<t>If the request is successful, the EST server response MUST contain
a HTTP 200 response code with a content-type of "application/json"
and a JSON object  <xref target="RFC7159"/> with the member nonce. The expiry
member is optional and indicates the time the nonce is considered
valid. After the expiry time is expired, the session is likely
garbage collected.</t>

<t>Below is a non-normative example of the response given by the EST server:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Content-Type: application/json

{
    "nonce": "MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTI=",
    "expiry": "2031-10-12T07:20:50.52Z"
}
]]></artwork></figure>

<t>[Open Issue: Should we also register a content type for use with
EST over CoAP where the nonce and the expiry field is encoded in
a CBOR structure?]</t>

</section>
<section anchor="nonce-processing-guidelines"><name>Nonce Processing Guidelines</name>

<t>When the RA/CA is requested or configured to transmit a nonce to an
end entity then it interacts with the Verifier.
The Verifier is, according to the IETF RATS architecture <xref target="RFC9334"/>, "a role
performed by an entity that appraises the validity of Evidence about
an Attester and produces Attestation Results to be used by a Relying
Party." Since the Verifier validates Evidence it is also the source
of the nonce to check for replay.</t>

<t>The nonce value MUST contain a random byte sequence whereby the length
depends on the used remote attestation technology.
Since the nonce is relayed with the RA/CA, it MUST be copied to
the respective structure, as described in <xref target="EST"/> and <xref target="CMP"/>, for
transmission to the Attester.</t>

<t>For example, the PSA attestation token <xref target="I-D.tschofenig-rats-psa-token"/>
supports nonces of length 32, 48 and 64 bytes. Other attestation
technologies use nonces of similar length. The assumption in this
specification is that the RA/CA have out-of-band knowledge about the
required nonce length required for the attestation technology used by
the end entity. The nonces of incorrect length will cause the remote
attestation protocol to fail.</t>

<t>When the end entity receives the nonce it MUST use it, if remote
attestation is available and supports nonces. It is better for an
RA/CA to be aggressive in sending a nonce, at least where there is a
reasonable chance the client supports remote attestation and the
client should be allowed to ignore the nonce if it either does not
support it or cannot use it for policy reasons.</t>

<t>While the semantics of the attestation API and the software/hardware
architecture is out-of-scope of this specification, the API will return
Evidence from the Attester in a format specific to the attestation technology
utilized. The encoding of the returned evidence varies but will be placed
inside the CSR, as specified in <xref target="I-D.ietf-lamps-csr-attestation"/>. The
software creating the CSR will not have to interpret the Evidence format
- it is treated as an opaque blob. It is important to note that the
nonce is carried in the Evidence, either implicitly or explicitly, and
it MUST NOT be conveyed in CSR structures outside the Evidence payload.</t>

<t>The processing of the CSR containing Evidence is described in
<xref target="I-D.ietf-lamps-csr-attestation"/>. Note that the issued certificates
does not contain the nonce, as explained in
<xref target="I-D.ietf-lamps-csr-attestation"/>.</t>

</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<t>[Editor's Note: The ASN.1 module OID (TBD2) and the new private
extension (TBD1) must be registered.]</t>

</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>This specification defines how to obtain a nonce via CMP and EST. This
specification assumes that the nonce does not require confidentiality protection
without impacting the security property of the remote attestation protocol.
<xref target="RFC9334"/> defines the IETF remote attestation architecture discusses
nonce-based freshness in great detail.</t>

<t>For the use of Evidence in the CSR the security considerations of
<xref target="I-D.ietf-lamps-csr-attestation"/> are relevant to this document.</t>

</section>
<section anchor="asn.1"><name>ASN.1 Definitions</name>

<t>TBD:</t>

</section>


  </middle>

  <back>


    <references title='Normative References' anchor="sec-normative-references">



<reference anchor="RFC2119">
  <front>
    <title>Key words for use in RFCs to Indicate Requirement Levels</title>
    <author fullname="S. Bradner" initials="S." surname="Bradner"/>
    <date month="March" year="1997"/>
    <abstract>
      <t>In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
    </abstract>
  </front>
  <seriesInfo name="BCP" value="14"/>
  <seriesInfo name="RFC" value="2119"/>
  <seriesInfo name="DOI" value="10.17487/RFC2119"/>
</reference>


<reference anchor="I-D.ietf-lamps-csr-attestation">
   <front>
      <title>Use of Remote Attestation with Certificate Signing Requests</title>
      <author fullname="Mike Ounsworth" initials="M." surname="Ounsworth">
         <organization>Entrust Limited</organization>
      </author>
      <author fullname="Hannes Tschofenig" initials="H." surname="Tschofenig">
         <organization>Siemens</organization>
      </author>
      <author fullname="Henk Birkholz" initials="H." surname="Birkholz">
         <organization>Fraunhofer SIT</organization>
      </author>
      <date day="13" month="February" year="2024"/>
      <abstract>
	 <t>   A client requesting a certificate from a Certification Authority (CA)
   may wish to offer believable claims about the protections afforded to
   the corresponding private key, such as whether the private key
   resides on a hardware security module or the protection capabilities
   provided by the hardware.

   This document describes how to encode Evidence produced by an
   Attester for inclusion in Certificate Signing Requests (CSRs), and
   any certificates necessary for validating it.

   Including Evidence along with a CSR can help to improve the
   assessment of the security posture for the private key, and the
   trustworthiness properties of the submitted key to the requested
   certificate profile.  These Evidence Claims can include information
   about the hardware component&#x27;s manufacturer, the version of installed
   or running firmware, the version of software installed or running in
   layers above the firmware, or the presence of hardware components
   providing specific protection capabilities or shielded locations
   (e.g., to protect keys).

	 </t>
      </abstract>
   </front>
   <seriesInfo name="Internet-Draft" value="draft-ietf-lamps-csr-attestation-05"/>
   
</reference>


<reference anchor="I-D.ietf-lamps-rfc4210bis">
   <front>
      <title>Internet X.509 Public Key Infrastructure -- Certificate Management Protocol (CMP)</title>
      <author fullname="Hendrik Brockhaus" initials="H." surname="Brockhaus">
         <organization>Siemens</organization>
      </author>
      <author fullname="David von Oheimb" initials="D." surname="von Oheimb">
         <organization>Siemens</organization>
      </author>
      <author fullname="Mike Ounsworth" initials="M." surname="Ounsworth">
         <organization>Entrust</organization>
      </author>
      <author fullname="John Gray" initials="J." surname="Gray">
         <organization>Entrust</organization>
      </author>
      <date day="19" month="June" year="2023"/>
      <abstract>
	 <t>   This document describes the Internet X.509 Public Key Infrastructure
   (PKI) Certificate Management Protocol (CMP).  Protocol messages are
   defined for X.509v3 certificate creation and management.  CMP
   provides interactions between client systems and PKI components such
   as a Registration Authority (RA) and a Certification Authority (CA).

   This document obsoletes RFC 4210 by including the updates specified
   by CMP Updates [RFCAAAA] Section 2 and Appendix A.2 maintaining
   backward compatibility with CMP version 2 wherever possible and
   obsoletes both documents.  Updates to CMP version 2 are: improving
   crypto agility, extending the polling mechanism, adding new general
   message types, and adding extended key usages to identify special CMP
   server authorizations.  Introducing version 3 to be used only for
   changes to the ASN.1 syntax, which are: support of EnvelopedData
   instead of EncryptedValue and hashAlg for indicating a hash
   AlgorithmIdentifier in certConf messages.

   In addition to the changes specified in CMP Updates [RFCAAAA] this
   document adds support for management of KEM certificates.

	 </t>
      </abstract>
   </front>
   <seriesInfo name="Internet-Draft" value="draft-ietf-lamps-rfc4210bis-07"/>
   
</reference>

<reference anchor="RFC8295">
  <front>
    <title>EST (Enrollment over Secure Transport) Extensions</title>
    <author fullname="S. Turner" initials="S." surname="Turner"/>
    <date month="January" year="2018"/>
    <abstract>
      <t>The EST (Enrollment over Secure Transport) protocol defines the Well-Known URI (Uniform Resource Identifier) -- /.well-known/est -- along with a number of other path components that clients use for PKI (Public Key Infrastructure) services, namely certificate enrollment (e.g., /simpleenroll). This document defines a number of other PKI services as additional path components -- specifically, firmware and trust anchors as well as symmetric, asymmetric, and encrypted keys. This document also specifies the PAL (Package Availability List), which is an XML (Extensible Markup Language) file or JSON (JavaScript Object Notation) object that clients use to retrieve packages available and authorized for them. This document extends the EST server path components to provide these additional services.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="8295"/>
  <seriesInfo name="DOI" value="10.17487/RFC8295"/>
</reference>

<reference anchor="RFC7030">
  <front>
    <title>Enrollment over Secure Transport</title>
    <author fullname="M. Pritikin" initials="M." role="editor" surname="Pritikin"/>
    <author fullname="P. Yee" initials="P." role="editor" surname="Yee"/>
    <author fullname="D. Harkins" initials="D." role="editor" surname="Harkins"/>
    <date month="October" year="2013"/>
    <abstract>
      <t>This document profiles certificate enrollment for clients using Certificate Management over CMS (CMC) messages over a secure transport. This profile, called Enrollment over Secure Transport (EST), describes a simple, yet functional, certificate management protocol targeting Public Key Infrastructure (PKI) clients that need to acquire client certificates and associated Certification Authority (CA) certificates. It also supports client-generated public/private key pairs as well as key pairs generated by the CA.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="7030"/>
  <seriesInfo name="DOI" value="10.17487/RFC7030"/>
</reference>

<reference anchor="RFC5280">
  <front>
    <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
    <author fullname="D. Cooper" initials="D." surname="Cooper"/>
    <author fullname="S. Santesson" initials="S." surname="Santesson"/>
    <author fullname="S. Farrell" initials="S." surname="Farrell"/>
    <author fullname="S. Boeyen" initials="S." surname="Boeyen"/>
    <author fullname="R. Housley" initials="R." surname="Housley"/>
    <author fullname="W. Polk" initials="W." surname="Polk"/>
    <date month="May" year="2008"/>
    <abstract>
      <t>This memo profiles the X.509 v3 certificate and X.509 v2 certificate revocation list (CRL) for use in the Internet. An overview of this approach and model is provided as an introduction. The X.509 v3 certificate format is described in detail, with additional information regarding the format and semantics of Internet name forms. Standard certificate extensions are described and two Internet-specific extensions are defined. A set of required certificate extensions is specified. The X.509 v2 CRL format is described in detail along with standard and Internet-specific extensions. An algorithm for X.509 certification path validation is described. An ASN.1 module and examples are provided in the appendices. [STANDARDS-TRACK]</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="5280"/>
  <seriesInfo name="DOI" value="10.17487/RFC5280"/>
</reference>

<reference anchor="RFC5785">
  <front>
    <title>Defining Well-Known Uniform Resource Identifiers (URIs)</title>
    <author fullname="M. Nottingham" initials="M." surname="Nottingham"/>
    <author fullname="E. Hammer-Lahav" initials="E." surname="Hammer-Lahav"/>
    <date month="April" year="2010"/>
    <abstract>
      <t>This memo defines a path prefix for "well-known locations", "/.well-known/", in selected Uniform Resource Identifier (URI) schemes. [STANDARDS-TRACK]</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="5785"/>
  <seriesInfo name="DOI" value="10.17487/RFC5785"/>
</reference>

<reference anchor="RFC7159">
  <front>
    <title>The JavaScript Object Notation (JSON) Data Interchange Format</title>
    <author fullname="T. Bray" initials="T." role="editor" surname="Bray"/>
    <date month="March" year="2014"/>
    <abstract>
      <t>JavaScript Object Notation (JSON) is a lightweight, text-based, language-independent data interchange format. It was derived from the ECMAScript Programming Language Standard. JSON defines a small set of formatting rules for the portable representation of structured data.</t>
      <t>This document removes inconsistencies with other specifications of JSON, repairs specification errors, and offers experience-based interoperability guidance.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="7159"/>
  <seriesInfo name="DOI" value="10.17487/RFC7159"/>
</reference>




    </references>

    <references title='Informative References' anchor="sec-informative-references">



<reference anchor="RFC9334">
  <front>
    <title>Remote ATtestation procedureS (RATS) Architecture</title>
    <author fullname="H. Birkholz" initials="H." surname="Birkholz"/>
    <author fullname="D. Thaler" initials="D." surname="Thaler"/>
    <author fullname="M. Richardson" initials="M." surname="Richardson"/>
    <author fullname="N. Smith" initials="N." surname="Smith"/>
    <author fullname="W. Pan" initials="W." surname="Pan"/>
    <date month="January" year="2023"/>
    <abstract>
      <t>In network protocol exchanges, it is often useful for one end of a communication to know whether the other end is in an intended operating state. This document provides an architectural overview of the entities involved that make such tests possible through the process of generating, conveying, and evaluating evidentiary Claims. It provides a model that is neutral toward processor architectures, the content of Claims, and protocols.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="9334"/>
  <seriesInfo name="DOI" value="10.17487/RFC9334"/>
</reference>


<reference anchor="I-D.tschofenig-rats-psa-token">
   <front>
      <title>Arm&#x27;s Platform Security Architecture (PSA) Attestation Token</title>
      <author fullname="Hannes Tschofenig" initials="H." surname="Tschofenig">
         </author>
      <author fullname="Simon Frost" initials="S." surname="Frost">
         <organization>Arm Limited</organization>
      </author>
      <author fullname="Mathias Brossard" initials="M." surname="Brossard">
         <organization>Arm Limited</organization>
      </author>
      <author fullname="Adrian L. Shaw" initials="A. L." surname="Shaw">
         <organization>HP Labs</organization>
      </author>
      <author fullname="Thomas Fossati" initials="T." surname="Fossati">
         <organization>Linaro</organization>
      </author>
      <date day="21" month="February" year="2024"/>
      <abstract>
	 <t>   The Arm Platform Security Architecture (PSA) is a family of hardware
   and firmware security specifications, as well as open-source
   reference implementations, to help device makers and chip
   manufacturers build best-practice security into products.  Devices
   that are PSA compliant can produce attestation tokens as described in
   this memo, which are the basis for many different protocols,
   including secure provisioning and network access control.  This
   document specifies the PSA attestation token structure and semantics.

   The PSA attestation token is a profile of the Entity Attestation
   Token (EAT).  This specification describes what claims are used in an
   attestation token generated by PSA compliant systems, how these
   claims get serialized to the wire, and how they are cryptographically
   protected.

   This informational document is published as an independent submission
   to improve interoperability with ARM&#x27;s architecture.  It is not a
   standard nor a product of the IETF.

	 </t>
      </abstract>
   </front>
   <seriesInfo name="Internet-Draft" value="draft-tschofenig-rats-psa-token-22"/>
   
</reference>


<reference anchor="TPM20" target="https://trustedcomputinggroup.org/resource/tpm-library-specification/">
  <front>
    <title>Trusted Platform Module Library Specification, Family 2.0, Level 00, Revision 01.59</title>
    <author >
      <organization>Trusted Computing Group</organization>
    </author>
    <date year="2019" month="November"/>
  </front>
</reference>


    </references>


<?line 392?>

<section anchor="acknowledgments"><name>Acknowledgments</name>

<t>We would like to thank Russ Housley, Thomas Fossati, Ionut Mihalcea and Carl Wallace for their review comments.</t>

</section>


  </back>

<!-- ##markdown-source:
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
Jei3/SUy0P5/x+Czt4g+AAA=

-->

</rfc>

