



JOSE                                                       H. Tschofenig
Internet-Draft                                                          
Intended status: Best Current Practice                      L. Hazlewood
Expires: 22 April 2024                                   20 October 2023


     Guidance for COSE and JOSE Protocol Designers and Implementers
                 draft-tschofenig-jose-cose-guidance-00

Abstract

   JSON Object Signing and Encryption (JOSE) and CBOR Object Signing and
   Encryption (COSE) are two widely used security wrappers, which have
   been developed in the IETF and have intentionally been kept in sync.

   This document provides guidance for protocol designers developing
   extensions for JOSE/COSE and for implementers of JOSE/COSE libraries.
   Developers of application using JSON and/or JOSE should also read
   this document but are realistically more focused on the documentation
   offered by the library they are using.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 22 April 2024.

Copyright Notice

   Copyright (c) 2023 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components



Tschofenig & Hazlewood    Expires 22 April 2024                 [Page 1]

Internet-Draft             COSE/JOSE Guidance               October 2023


   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology and Requirements Language . . . . . . . . . . . .   3
   3.  Key Identification  . . . . . . . . . . . . . . . . . . . . .   3
   4.  Guidance  . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   4
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   4
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   4
   Appendix A.  Acknowledgments  . . . . . . . . . . . . . . . . . .   5
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   JSON Object Signing and Encryption (JOSE) has initially been designed
   to offer provide a security wrapper for access tokens used by the
   OAuth protocol.  The larger applicability of a standard for
   describing a security-related meta-data was, however, immediately
   recognized.  Today, JOSE is in wide spread use.

   With the development of CBOR a binary encoding format was developed
   to address use cases where JSON was too verbose.  A security wrapper
   that uses CBOR-based encoding was needed and CBOR Object Signing and
   Encryption (COSE) was standardized.

   The JOSE and COSE specifications have intentionally been kept in sync
   since protocols and payloads today are often described in the Concise
   Data Definition Language (CDDL) and serialized to either JOSE or COSE
   thereby making them attractive to developers from the web and the
   embedded world at the same time.  Due to the similarity of the
   designs, the guidance provided in this document is therefore
   applicable to JOSE and COSE.

   Unfortunately, some practices cause challenges from a security point
   of view and this document captures those.  We hope that this document
   helps to design better extensions for JOSE/COSE and to make the life
   of developers easier.

   The document is structured as follows.  Section 3 describes the
   challenges with key identification.  Future versions of this document
   will add further challenges.  Section 4 then offers guidance for how
   to create better designs for JOSE/COSE.



Tschofenig & Hazlewood    Expires 22 April 2024                 [Page 2]

Internet-Draft             COSE/JOSE Guidance               October 2023


2.  Terminology and Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

3.  Key Identification

   The security wrappers in JOSE and COSE use a simple design, at least
   for the basic functionality like digital signatures and MACs for a
   single recipient.

   The structure is as follows:

   *  A header, which is split into a protected and unprotected
      parameters.

   *  An optional payload.  It is optional because the payload may be
      detached.  This is the payload we want to protect.  In many
      applications this payload is a JSON-based payload (in case of
      JOSE) or a CBOR-encoded payload (in case of COSE).  Various IETF
      specifications exist that standardize the content of these
      payloads.

   *  A digital signature, a tag (for a MAC), or a ciphertext (for
      encryption).

   The purpose of the header is to provide instructions for the
   protection of the payload, including

   *  algorithm information used to provide protection of the payload,

   *  the identification of the key to verify the digital signature,
      MAC, or encryption,

   *  X.509 certificates and certificate chains,

   *  countersignature.

   Although the layering is quite simple with the header providing the
   information to provide protection of the payload, some specifications
   and applications started to place information for key identification
   inside the payload.  This approach destroys the clear layering.

   Additionally, it forces a JOSE/COSE parser to defer security
   processing of the payload to a later point in time and to look inside
   the payload to find the appropriate keying material to subsequently
   verify the payload.



Tschofenig & Hazlewood    Expires 22 April 2024                 [Page 3]

Internet-Draft             COSE/JOSE Guidance               October 2023


   There is no need for such design since there are existing header
   parameters available to store the necessary information.  If those
   headers are insufficient, then it is always possible to define new
   header parameter to convey this informtion.  This approach also
   simplifies libraries since they do not need to understand the payload
   content to fetch the correct information.

   Finally, an easy transition from a system using digital signatures
   over payloads to encrypted payloads is not possible since information
   needed for key look-up are found in the encrypted payload.  A re-
   design would therefore be required.

4.  Guidance

   We RECOMMEND that protocol designers and implementers use the
   available header parameter for key identification.  If the
   standardized parameters are insufficient, new header parameters can
   be defined.  Re-using existing header parameters will improve
   interoperability because there are a limited number of cases on how
   to select a key.

   Information that is needed for determining the keying material needed
   to cryptographically verify the protected payload MUST be placed into
   the header of the JOSE/COSE security wrapper.

5.  IANA Considerations

   This document does not make requests to IANA.

6.  Security Considerations

   This specification makes security recommendations for the JOSE/COSE
   specification suite.  Therefore, it is entirely about security.

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

7.2.  Informative References

   [I-D.tschofenig-rats-psa-token]
              Tschofenig, H., Frost, S., Brossard, M., Shaw, A. L., and
              T. Fossati, "Arm's Platform Security Architecture (PSA)



Tschofenig & Hazlewood    Expires 22 April 2024                 [Page 4]

Internet-Draft             COSE/JOSE Guidance               October 2023


              Attestation Token", Work in Progress, Internet-Draft,
              draft-tschofenig-rats-psa-token-13, 1 September 2023,
              <https://datatracker.ietf.org/doc/html/draft-tschofenig-
              rats-psa-token-13>.

Appendix A.  Acknowledgments

   TBD: Add your name here.

Authors' Addresses

   Hannes Tschofenig
   Email: hannes.tschofenig@siemens.com


   Les Hazlewood
   Email: lhazlewood@gmail.com


































Tschofenig & Hazlewood    Expires 22 April 2024                 [Page 5]
